# Интеграции: Kubernetes, GitHub, Shell

## Общие требования

- Любая внешняя операция имеет явный timeout.
- Повторные попытки (retry) управляются политикой, а не ad-hoc циклами.
- Ошибки внешних систем нормализуются в ошибки сценария.
- Секреты никогда не логируются.

## Kubernetes

- Вызовы Kubernetes инкапсулируются в adapter-слое.
- Предпочтительно использовать устойчивый API-клиент; использование `kubectl` допустимо,
  но должно быть изолировано одним adapter-контрактом.
- Операции apply/wait/delete должны поддерживать:
  - request timeout;
  - диагностируемые ошибки;
  - идемпотентное поведение при повторном запуске.

## GitHub

- Вызовы GitHub инкапсулируются в отдельный adapter.
- Предпочтительно использовать SDK/API-клиент; использование `gh` допустимо как переходный этап,
  но с явной миграционной целью.
- Контрактные операции (issue/pr/review/branch) должны иметь стабильные интерфейсы в приложении.

## Shell/process execution

- Любой shell-вызов выполняется только через контролируемый adapter.
- Нельзя склеивать пользовательский ввод в команду без валидации и безопасного quoting.
- Для каждой команды фиксируются:
  - timeout;
  - рабочая директория;
  - необходимый env;
  - ожидаемый формат stdout/stderr.

## Hooks

- Hooks считаются внешним side effect механизмом.
- Hook-исполнение должно быть предсказуемым, с явной политикой continue-on-error.
- Любой встроенный hook должен иметь документированный контракт полей `with`.

## Проверки перед выполнением сценариев

- Наличие обязательных бинарников проверяется отдельным шагом.
- Ошибка preflight должна быть ранней и понятной пользователю.
